<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/mainLayout">

<head>
	<th:block th:replace="fragments/head_inc :: head_inc" />
</head>
<body id="body">
    <div id="wrap">
		<div class="container">
			<div id="content">
			
                <div class="page_info_area">
                    <div class="left">
                        <div class="location_area">
                            <a href="#" class="bookmark active" title="즐겨찾기"></a>
                            <ul>
                                <li>홈</li>
                                <li>학습모듈관리</li>
								<li>학습모듈관리 목록</li>
                            </ul>
                        </div>
                        <div class="title_area">
                            <p>학습모듈관리 목록</p>
                            <a href="#" class="reload_btn" title="새로고침">새로고침</a>
                            <a href="#" class="help_btn" title="도움말">도움말</a>
                        </div>
                    </div>
                    <div class="right">
                        <div class="button_area">
                        	<button class="btn" title="조회" onclick="fnSearch(); return false;">조회</button>
                            <button class="btn" title="모듈추가" onclick="fnOpenModuleDetail('R'); return false;">모듈추가</button>
                        </div>
                    </div>
                </div>
                
                <div class="content_area">
                    <div class="division20">
                        <div class="search_wrap">
                            <table class="search fixed">
                            	<colgroup>
	                            	<col style="width:100px;" />
	                                <col style="width:auto;" />
	                                <col style="width:60px;" />
	                                <col style="width:100px" />
	                                <col style="width:auto;" />
	                                <col style="width:60px;" />
	                                <col style="width:100px" />
	                                <col style="width:auto;" />
	                            </colgroup>
	                            <tbody>
	                            	<tr>
	                            		<th scope="row"><label for="moduleTyCd">모듈 타입</label></th>
                						<td>
                							<div class="selectbox">
                								<select id="moduleTyCd" name="moduleTyCd">
                									<option value="">선택</option>
                								</select>
                							</div>
                						</td>
                						<td></td>
                						<th scope="row"><label for="libTyCd">라이브러리 타입</label></th>
                						<td>
                							<div class="selectbox">
                								<select id="libTyCd" name="libTyCd">
                									<option value="">선택</option>
                								</select>
                							</div>
                						</td>
                						<td></td>
                						<th scope="row"><label for="moduleNm">모듈명</label></th>
                						<td><input type="text" class="in_w100" id="moduleNm" name="moduleNm" /></td>
	                            	</tr>
	                            </tbody>
                            </table>
                		</div>
                	</div>
                	
                	<div class="division20">
                		<div class="table_area marginb25">
                			<table class="list fixed" id="tb_data_table">
                				<colgroup>
                            		<col width="60px;" />
									<col width="120px;" />
									<col width="120px;" />
									<col width="auto;" />
									<col width="220px;" />
									<col width="220px;" />
									<col width="80px;" />
									<col width="auto;" />
                            	</colgroup>
                				<thead>
									<tr>
										<th>순번</th>
										<th>모듈타입</th>
										<th>라이브러리타입</th>
										<th>모듈명</th>
										<th>모듈패키지명</th>
										<th>모듈클래스명</th>
										<th>파라미터 수</th>
										<th>모듈설명</th>
									</tr>
								</thead>
								<tbody>
									<tr class="fwk_templete_row">
										<td>#{FWK_TR_NO_DESC}</td>
										<td>#{moduleTyCdNm}</td>
										<td>#{libTyCdNm}</td>
										<td class="alignl"><a href="#" onclick="fnOpenModuleDetail('M', '#{moduleSn}'); return false;">#{moduleNm}</a></td>
										<td class="alignl">#{modulePckageNm}</td>
										<td class="alignl">#{moduleClassNm}</td>
										<td class="alignr">#{paramtrCnt}</td>
										<td class="alignl">#{moduleDc}</td>
									</tr>
								</tbody>
                			</table>
                		</div>
                		<div class="pagination_area marginb25" id="dv_paging"></div>
                	</div>
                </div>
			</div>
		</div>
	</div>
	
	
	<div class="popup layer" id="modal_mdl">
	</div>


<script type="text/javascript">

$(document).ready(function() {
	
	$("#moduleNm").on("keyup", function(event) {
		if(event.keyCode == 13) 
			fnSearch();
	});
	
	// 공통코드 load
	fnInit();
	
});


function fnInit() {
	
	new CodeBinder()
	.setCommonCode("MODLTP","moduleTyCd")
	.setCommonCode("MODLIBTP","libTyCd")
	.load();
	
	fnSearch();
}


function fnSearch(pageNum) {
	if(!pageNum) 
		pageNum = 1;
	
	$.ajax({
		url: "/json/learningModuleInfo/getLearningModuleList"
		, method : "POST"
		, contentType: 'application/json'
		, data: JSON.stringify({
			pageNum: pageNum
			, moduleTyCd: $("#moduleTyCd").val()
			, libTyCd: $("#libTyCd").val()
			, moduleNm: $("#moduleNm").val()
		})
		, success: function(data){
			
			fnBindTableValue("tb_data_table", data.moduleList, data.pagingInfo);
			
			fnSetPaging("dv_paging", data.pagingInfo);
			
			
		}
	});
	 
} 



function fnOpenModuleDetail(pmode, moduleSn) {
	//window.open('/open/mlms/learning_modl/learning_modl_form?moduleSn=' + moduleSn, '_blank', 'width=1200, height=600, resize=yes');
	show_loading_bar_flag = false;
	if(!moduleSn)
		var moduleSn = "";
	
	$.ajax({
		url: "/view/learningModuleInfo/viewLearningModuleInfo?pmode=" + pmode + "&moduleSn=" + moduleSn
		, contentType: 'application/json'
		, method : "POST"
		, success: function(data){
	
			$("#modal_mdl").empty();
			$("#modal_mdl").html(data);
			
			fnShowModal("modal_mdl");
		}
	});
	
	show_loading_bar_flag = true;
}


</script>
</body>
</html>

					 