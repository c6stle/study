<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ct_collect_group">

	<!-- 메타그룹 검색 조건 -->
	<sql id="selectMetaGroupList_whereSearch">
		<if test="searchValue != null and searchType != null">
	 		<if test="searchType == 'API_GROUP_CD' ">
	 			AND API_GROUP_CD LIKE CONCAT('%',#{searchValue},'%')
	 		</if>
	 		<if test="searchType == 'API_GROUP_NM' ">
	 			AND API_GROUP_NM LIKE CONCAT('%',#{searchValue},'%')
	 		</if>
	 		<if test="searchType == 'API_STNG_NM' ">
	 			AND API_STNG_NM LIKE CONCAT('%',#{searchValue},'%')
	 		</if>
	 	</if>
		<if test="useAt != null and useAt != ''">
			AND USE_YN = #{useAt}
		</if>
	</sql>

	<!-- 메타그룹 리스트 조회 -->
	<select id="selectMetaGroupList" parameterType="map" resultType="sangsMap">
		SELECT
		    API_GROUP_CD
			, API_GROUP_NM
			, API_STNG_NM
			, API_GROUP_CN
			, USE_YN
		FROM
		    CT_API_GROUP
		WHERE 1=1
		    <include refid="selectMetaGroupList_whereSearch" />
		ORDER BY
		    API_GROUP_CD ASC
		LIMIT #{pageSize} OFFSET #{offset}
	</select>

	<!-- 메타그룹 리스트 카운트조회 -->
	<select id="selectMetaGroupListCnt" parameterType="map" resultType="Integer">
		SELECT
			COUNT(*) AS CNT
		FROM
		    CT_API_GROUP
		WHERE 1=1
			<include refid="selectMetaGroupList_whereSearch" />
	</select>

	<!-- 메타그룹 상세 조회 -->
	<select id="selectMetaGroupInfo" parameterType="map" resultType="sangsMap">
		SELECT
			*
		FROM
		    CT_API_GROUP
		WHERE 1=1
			AND API_GROUP_CD LIKE #{apiGroupCd}
	</select>

	<!-- 메타그룹 중복 조회 -->
	<select id="selectMetaGroupInfoCkDup" parameterType="map" resultType="Integer">
		SELECT
			COUNT(*)
		FROM
		    CT_API_GROUP
		WHERE 1=1
			AND API_GROUP_CD LIKE #{apiGroupCd}
	</select>

	<insert id="insertMetaGroup" parameterType="map">
		INSERT INTO CT_API_GROUP(
			API_GROUP_CD
			, API_GROUP_NM
			, API_STNG_NM
			, API_GROUP_CN
			, USE_YN
		)VALUES(
			#{apiGroupCd}
			, #{apiGroupNm}
			, #{apiStngNm}
			, #{apiGroupCn}
			, #{useYn}
		)
	</insert>

	<update id="updateMetaGroup" parameterType="map">
		UPDATE CT_API_GROUP
		SET
			API_GROUP_NM=#{apiGroupNm}
			, API_STNG_NM=#{apiStngNm}
			, API_GROUP_CN=#{apiGroupCn}
			, USE_YN=#{useYn}
		WHERE 1=1
			AND API_GROUP_CD=#{apiGroupCd}
	</update>
</mapper>