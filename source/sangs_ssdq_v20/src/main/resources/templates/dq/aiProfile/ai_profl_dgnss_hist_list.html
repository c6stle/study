<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/mainLayout">

<head>
	<th:block th:replace="fragments/head_inc :: head_inc" />
</head>

<body id="body">
	<div id="wrap">
		<div class="container">
			<div id="content">
				<div class="page_info_area">
					<div class="left">
						<div class="title_area">
							<p>테이블 구조 분석</p>
							<a href="#" class="reload_btn" title="새로고침">새로고침</a>
						</div>
					</div>
					<div class="right">
						<div class="button_area">
							<button class="btn" title="조회" onclick="fnSearch(); return false;">조회</button>
						</div>
					</div>
				</div><!-- page_info_area -->
				
				
				<div class="content_area">
					<div class="division20">
						<div class="search_wrap card">
						
						
							<table class="search fixed">
								<colgroup>
									<col width="80px;" />
									<col width="120px;" />
									<col width="20px;" />
									<col width="auto;" />
								</colgroup>
								<tbody>
									<tr>
										<th>검색조건</th>
										<td>
											<div class="selectbox">
												<select name="searchKey" id="searchKey">
												 	<option value="">조회 조건</option>
													<option value="dbmsIpAddr">DBMS서버IP</option>
													<option value="dbmsPortNo">PORT</option>
													<option value="dbmsDatabaseNm">DB명</option>
													<option value="dbmsUserId">DB접속계정</option>
													<option value="excSttusCd">수행결과</option>
	                                            </select>
	                                            <label>조회 조건</label>
											</div>
										</td>
										<td></td>
										<td><input type="text" name="searchKeyVal" id="searchKeyVal" style="width:400px;"/></td>
									</tr>
								</tbody>
							</table>
							
							
						</div><!-- search_wrap -->
					</div><!-- division20 -->


					<div class="division20">
						<div class="card">
							
								<table class="list fixed marginb25" id="tb_data_table">
									<colgroup>
										<col width="4%" />
										<col width="9%" />
										<col width="6%" />
										<col width="9%" />
										<col width="9%" />
										<col width="12%" />
										<col width="12%" />
										<col width="6%" />
										<col width="6%" />
										<col width="8%" />
										<col width="8%" />
										<col width="8%" />
									</colgroup>
									<thead>
										<tr>
											<th>No</th>
											<th>점검 일자</th>
											<th>데이터 준수(%)</th>
											<th>DMBS서버IP</th>
											<th>PORT</th>
											<th>DB명</th>
											<th>DB접속계정</th>
											<th>점검 데이터 수</th>
											<th>이상 데이터 수</th>
											<th>자연어 분석 여부</th>
											<th>수행 결과</th>
											<th>수행 시간</th>
										</tr>
									</thead>
									<tbody>
										<tr class="fwk_templete_row">
											<td>#{atmcDgnssExcnSn}</td>
											<td>#fn{replaceAll('#{regDt}',' ', '<br/>')}</td>
											<td class="alignr">#{databaseObsryRate}%</td>
											<td>#{dbmsIpAddr}</td>
											<td>#{dbmsPortNo}</td>
											<td><a style="color:#2a88e5;" href="#" onclick="fnGoDetail('#{atmcDgnssExcnSn}'); return false;">#{dbmsDatabaseNm}</a></td>
											<td>#{dbmsId}</td>
											<td class="alignr">#fn{fnFormatNumber(#{totalCnt})}</td>
											<td class="alignr">#fn{fnFormatNumber(#{totalErrCnt})}</td>
											<td>#{nlpAnlsYn}</td>
											<td>#{excSttusCd}</td>
											<td>#fn{fnDateTextBySec(#{diffSecond})}</td>
										</tr>
									</tbody>
								</table>


							
							<div class="pagination_area marginb25" id="dv_paging"></div>
							
						</div><!-- card -->
					</div><!-- division20 -->

				</div><!-- content_area -->

			</div><!-- content -->
		</div><!-- container -->
	</div><!-- wrap -->
</body>

<script type="text/javascript">

$(document).ready(function() {
	fnSearch();
	
	$("#searchKeyVal").on("keyup", function(event) {
		if(event.keyCode == 13) {
			fnSearch();
		}
	});
});


function fnSearch(pageNum) {
	
	if(!pageNum)
		pageNum = 1;
	
	var searchKey = $("#searchKey").val();
	var searchKeyVal = $("#searchKeyVal").val();
	
	$.ajax({
		url: '/json/aiProfileMng/getAutoDgnssHistList'
		, method : 'POST'
		, contentType: 'application/json'
		, data: JSON.stringify({
			 pageNum: pageNum
			 , searchKey: searchKey
			 , searchKeyVal: searchKeyVal
		}) 
		, success: function(data){
			
			fnBindTableValue("tb_data_table", data.autoDgnssInfoList, data.pagingInfo);
			
			fnSetPaging("dv_paging", data.pagingInfo);
		}
	});
}



function fnGoDetail(atmcDgnssExcnSn) {
	//console.log(atmcDgnssExcnSn);
	location.href = "/open/dq/aiProfile/ai_profl_dgnss_result_view?atmcDgnssExcnSn=" + atmcDgnssExcnSn;
}

</script>

</html>