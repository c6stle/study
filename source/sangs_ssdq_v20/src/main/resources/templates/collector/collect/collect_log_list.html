<!--
	Description : (팝업)수집통합관리 > 수집설정 리스트

	Modification Information
	수정일				수정자			수정내용
	-------		-----------------------------------
	2016.01.30		조남훈

-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/mainLayout">
<head>
	<th:block th:replace="fragments/head_inc :: head_inc" />

	<style>
		.guide_box {
			margin-bottom: 15px;
		    padding: 12px;
		    border: 1px solid #d6d5c9;
		    background-color: #fefbde;
		}
	</style>

<script type="text/javascript" th:inline="javascript">

$(document).ready(function(){

	$("#apiCd").on("keyup", function(event) {
		if(event.keyCode == 13) {
			fnSearch();
		}
	});

	$("#rspnsResultCd").on("keyup", function(event) {
		if(event.keyCode == 13) {
			fnSearch();
		}
	});

	fnSetPaging("dv_paging", /*[[${pagingInfo}]]*/null);

	// 달력 set
	$("#logBeginYmd").datepicker();
	$("#logEndYmd").datepicker();
	
	// datepicker의 조회조건의 from을 1년전 부터 오늘까지로 셋팅해줌
	fnSet1YearFromTo("#logBeginYmd", "#logEndYmd");

	// datepicker 버튼 왼쪽에 간격주기
	$(".ui-datepicker-trigger").css("margin-left", "2px");


	//$(".colorboxIframe").colorbox({iframe:true, width:"620px", height:"640"});

});

//조회
function fnSearch(pageIdx) {
	// 날짜 조건 체크
	if(!fnSearcDateChk($("#logBeginYmd").val(), $("#logEndYmd").val())) return;

	if(pageIdx)
		$('#pageIndex').val(pageIdx);
	$('#listType').val("LIST");
	$('#frm').attr("target", "_self");
	$('#frm').submit();

}


</script>

</head>
<body>

<div id="wrap">
	<div class="container">
		<div id="content">
			<div class="page_info_area">
				<div class="left">
					<div class="title_area">
						<p>수집통합관리</p>
						<a href="#" class="reload_btn" title="새로고침">새로고침</a>
					</div>
				</div>
				<div class="right">
					<div class="btn_wrap">
						<button type="button" class="btn green" onclick="fnSearch('1');" >조회</button>
					</div>
				</div>
			</div><!-- page_info_area -->

			<div class="content_area">
				<div class="division20">
					<!-- 검색 영역 -->
					<form name="frm" id="frm"  method="post" action="/collector/collect/collect_log_list">
						<input type="hidden" name="pageIndex" id="pageIndex" th:value="${pagingInfo.pageNum}" /><!-- 페이징 처리부분 -->
						<input type="hidden" name="listType" id="listType" value="" />
						<input type="hidden" name="pmode" id="pmode" th:value="${pmode}" />
						<!-- <input type="hidden" name="apiCd" id="apiCd" /* th:value="${params.apiCd}" */ /> -->
						<input type="hidden" name="tIdx" id="tIdx" <!--/* th:value="${params.tIdx}" */--> />

						<!--
						<div class="tbl_top">
							<p class="tit v2">수집로그 조회</p>
						</div>
						 -->

						<div class="guide_box">
							<p>
								<b>&#183;</b> 수집 설정해 놓은 시간에 맞게 수집된 데이터 리스트를 보여준다. <br>
								<b>&#183;</b> 해당 리스트를 클릭하여 상세정보화면을 보면 각 전문 별 수집된 데이터를 확인할 수 있다.<br>
							</p>
						</div>

						<div class="search_wrap card">
							<table class="search fixed">
								<caption>검색 테이블</caption>
								<colgroup>
									<col style="width: 5%;" />
									<col style="width: auto;" />
									<col style="width: 5%;" />
									<col style="width: auto;" />
									<col style="width: 5%;" />
									<col style="width: auto;" />
								</colgroup>
								<tbody>
									<tr>
										<th scope="row"><label for="apiCd">수집코드</label></th>
										<td>
											<input class="in_w95" type="text" title="수집코드" id="apiCd" name="apiCd" th:value="${#maps.containsKey(params, 'apiCd') ? params.apiCd : ''}"/>
										</td>
										<th scope="row"><label for="logYmd">기간</label></th>
										<td>
											<div class="calendar_box">
												<input type="text" title="시작일시" id="logBeginYmd" name="logBeginYmd" th:value="${params.logBeginYmd}" maxlength="10" autocomplete="off"/>
											</div> ~
											<div class="calendar_box">
				                        		<input type="text" title="종료일시" id="logEndYmd" name="logEndYmd" th:value="${params.logEndYmd}" maxlength="10" autocomplete="off"/>
											</div>
										</td>
										<th scope="row"><label for="rspnsResultCd">결과코드</label></th>
										<td><input type="text" class="in_w95" name="rspnsResultCd" id="rspnsResultCd" th:value="${#maps.containsKey(params, 'rspnsResultCd')} ? ${params.rspnsResultCd}" /></td>
										<!--/* <th scope="row"><label for="arngYn">정제여부</label></th>
										<td colspan="3">
											<select name="arngYn" id="arngYn">
												<option value="" th:selected="${#maps.containsKey(params, 'arngYn') ? params.arngYn eq '' : false}">선택</option>
												<option value="Y" th:selected="${#maps.containsKey(params, 'arngYn') ? params.arngYn eq 'Y' : false}">Y</option>
												<option value="N" th:selected="${#maps.containsKey(params, 'arngYn') ? params.arngYn eq 'N' : false}">N</option>
			                          		</select>
										</td> */-->
									</tr>
								</tbody>
							</table>
						</div> <!-- //table_wrap -->

					</form>
					<!-- //검색 영역 -->


					<div class="card">
						<table class="list fixed">
							<caption>조회된 테이블</caption>
							<colgroup>
								<col style="width: auto;" />
		                        <col style="width: auto;" />
		                        <col style="width: auto;" />
		                        <col style="width: auto;" />
		                        <col style="width: auto;" />
		                        <col style="width: auto;" />
		                        <col style="width: auto;" />
							</colgroup>
							<thead>
								<tr>
									 <th scope="col">수집코드</th>
		                             <th scope="col">년월일</th>
		                             <th scope="col">로그순번</th>
		                             <th scope="col">시작일자</th>
		                             <th scope="col">종료일자</th>
		                             <th scope="col">결과코드</th>
		                             <th scope="col">수집건수</th>
		                             <!--/* <th scope="col">정제여부</th> */-->
		                             <th scope="col"></th>
								</tr>
							</thead>
							<tbody>
								<th:block th:each="result : ${resultList}">
								<tr>
									 <td>[[${result.apiCd}]]</td>
		                             <td>[[${result.logYmdDe}]]</td>
		                             <td>[[${result.logSn}]]</td>
		                             <td>[[${result.bgngDt}]]</td>
		                             <td>[[${result.endDt}]]</td>
		                             <td>[[${result.rspnsResultCd}]]</td>
		                             <td>[[${result.rspnsResultCnt}]]</td>
		                             <!--/* <td>
		                             	<th:block th:if="${result.arngYn == 'Y'}">[[${result.arngYn}]]<br>([[${result.cleanDt}]])</th:block>
										<th:block th:unless="${result.arngYn == 'Y'}">N</th:block>
		                             </td> */-->
		                             <td>
		                             	<a th:href="@{/collector/collect/collect_log_data_list(apiCd=${result.apiCd}, logSn=${result.logSn}, logYmd=${result.logYmd})}" class="btn sm" style="color:black">상세정보</a>
		                             </td>
								</tr>
								</th:block>

								<th:block th:if="${#lists.size(resultList) == 0}">
								<tr>
									<td colspan="8">조회된 데이터가 없습니다.</td>
								</tr>
								</th:block>
							</tbody>
						</table>

						<div class="pagination_area marginb25" id="dv_paging"></div>
					</div> <!-- //card -->
				</div> <!-- //division20 -->
			</div> <!-- //content_area -->
		</div> <!-- //content -->
	</div> <!-- //container -->
</div>

</body>
</html>
