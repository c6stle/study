<html th:lang="ko" xmlns:th="http://www.thymeleaf.org">

<th:block th:fragment="word_list_reg_inc">
	<div class="pop_header">
		<p class="title">용어정보</p>
		<button class="btn_ic btn_pop_close" onclick="fnCloseModal('wordreginfo_modal');">닫기</button>
	</div>
	<div class="pop_content">
		
		<div class="card">
			<div class="tbl_top right">
				<div class="btn_wrap">
					<input type="hidden" name="regWordPmodeHide" id="regWordPmodeHide" />
					<input type="hidden" name="regWordSnHide" id="regWordSnHide" />
					<input type="hidden" name="regWordWrdRefrnStdSetSnHide" id="regWordWrdRefrnStdSetSnHide" />
					<input type="hidden" name="regWordWrdSnHide" id="regWordWrdSnHide" />
					<input type="hidden" name="regWordDomnRefrnStdSetSnHide" id="regWordDomnRefrnStdSetSnHide" />
					<input type="hidden" name="regWordDomnSnHide" id="regWordDomnSnHide" />
					<input type="hidden" name="regWordTyCdNmHide" id="regWordTyCdNmHide" />
					<input type="hidden" name="regWordDomnGroupNmHide" id="regWordDomnGroupNmHide" />
					<input type="hidden" name="regWordAprvSttusCdNmHide" id="regWordAprvSttusCdNmHide" />
					<button class="btn sm" onclick="fnRegWordBtn(); return false;" th:if="${session.STANDARD_USER_SESSION_KEY.userAttrMap[isApprover]} == 'Y'">저장(승인)</button>
					<button class="btn sm" onclick="fnRegWordBtn(); return false;" th:unless="${session.STANDARD_USER_SESSION_KEY.userAttrMap[isApprover]} == 'Y'">저장</button>
				</div>
			</div>
			
			<table class="view">
				<colgroup>
					<col width="10%" />
					<col width="auto" />
					<col width="10%" />
					<col width="auto" />
				</colgroup>
				<tbody>
					<tr id="regWord_tr_row0" style="display: none;">
						<th>용어검색</th>
						<td style="padding-right: 3px; border-right: 0px" >
							<div style="display: flex; align-items: center;">
								<input type="text" name="regWordSearchNm" id="regWordSearchNm" style="text-transform: uppercase;">
								<button class="btn sm" style="width: 80px; margin-left:4px" onclick="fnSearchWordNmListBtn();" >조회</button>
							</div>
						</td>
						<td colspan="2" style="border-left:0px;">※ 띄어쓰기 또는 언더바로 단어를 구분하면 조회 권장</td>
					</tr>
					<tr>
						<th>* 용어구분</th>
						<td>
							<div id="regWordTyCd">
							</div>
						</td>
						<th>승인상태</th>
						<td id="regWordAprvSttusCdNm" >
						</td>
					</tr>
					<tr>
						<th>* 용어명</th>
						<td>
							<input type="text" name="regWordNm" id="regWordNm" style="text-transform: uppercase;" readonly/>
						</td>
						<th>* 영문약어명</th>
						<td>
							<input type="text" name="regWordEngAbrvNm" id="regWordEngAbrvNm" style="text-transform: uppercase;" readonly/>
						</td>
					</tr>
					<tr id="regWord_tr_row3">
						<th>* 영문명</th>
						<td>
							<input type="text" name="regWordEngNm" id="regWordEngNm" style="text-transform: uppercase;" maxlength="100" />
						</td>
						<th>* 금칙어</th>
						<td>
							<div id="regWordPrhibtYn">
								<input type="radio" name="wordPrhibtYn" id="wordprhibtyn_y" value="Y"/>
								<label for="wordprhibtyn_y" class="req">Y</label>
								<input type="radio" name="wordPrhibtYn" id="wordprhibtyn_n" value="N"/>
								<label for="wordprhibtyn_n" class="req">N</label>
							</div>
						</td>
					</tr>
					
					<tr id="regWord_tr_row4">
						<th>* 도메인명</th>
						<td>
							<div class="div_container">
								<input type="text" name="regWordDomnNm" id="regWordDomnNm" autocomplete="off"/>
								<div class="div_drop" id="div_drop" style="display : none;">
									<ul class="ul_results" style="max-height: 300px;"> 
									</ul>
								</div>
							</div>
						</td>
						<th>* 도메인그룹</th>
						<td>
							<select name="regWordDomnGroupCode" id="regWordDomnGroupCode" disabled>
								<option value="">선택</option>
							</select>
						</td>
					</tr>
					<tr id="regWord_tr_row5">
						<th>연관어</th>
                        <td colspan="3">
                            <input type="text" name="regWordRelWordNm" id="regWordRelWordNm" maxlength="100" >
                        </td>
					</tr>
					<tr id="regWord_tr_row6">
						<th>용어설명</th>
                        <td colspan="3">
                            <textarea name="regWordCn" id="regWordCn" style="height: 140px; overflow:auto; padding: 10px;" maxlength="500" placeholder="500자 이내로 입력해주세요"></textarea>
                        </td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
		
	<div id="dv_wordnmlist_div" style="display: none;">
		<div class="tbl_top padt10">
			<p class="tit v2 margin0"><span>용어명 상세조회</span></p>
			<div class="btn_wrap">
				<button class="btn sm" onclick="fnRegChkBoxSlctnBtn();">확인</button>
				<button class="btn sm" onclick="fnRegCloseCheckWordNmBtn();">닫기</button>
			</div>
		</div>
		<div class="tbl_wrap" data-height="250">
			<div class="card">
				<table id="tb_wordnmlist_table" class="list margint0">
					<colgroup>
						<col style="width: 60px;" />
						<col style="width: auto;" />
						<col style="width: 60px;" />
						<col style="width: 100px;" />
						<col style="width: auto;" />
						<col style="width: auto;" />
						<col style="width: 80px;" />
						<col style="width: 100px;" />
						<col style="width: 60px;" />
						<col style="width: 70px;" />
						<col style="width: 70px;" />
						<col style="width: 100px;" />
						<col style="width: 80px;" />
					</colgroup>
					<thead>
						<tr>
							<th>No</th>
							<th>표준셋명</th>
							<th>단어구분</th>
							<th>단어명</th>
							<th>영문약어명</th>
							<th>영문명</th>
							<th>표준어</th>
							<th>연관어</th>
							<th>금칙어</th>
							<th>승인여부</th>
							<th>사용횟수</th>
							<th>비고</th>
							<th><a href="#" onclick="fnRegSearchedWrdSelectAll(); return false;" id="regSearchedWrdSelectAll" data-chkselected="N" style="color:black">선택</a></th>
						</tr>
					</thead>											
					<tbody>
						<tr class="fwk_templete_row">
							<td>#{FWK_TR_NO}</td>
							<td>#{stdSetNm}
								<input type="hidden" class="cl_regWord_stdSetSn" value="#{stdSetSn}"/>
								<input type="hidden" class="cl_regWord_wrdSn" value="#{wrdSn}"/>
								<input type="hidden" class="cl_regWord_aprvSttusCd" value="#{aprvSttusCd}"/>
								<input type="hidden" class="cl_regWord_stdSetTyCd" value="#{stdSetTyCd}"/>
								<input type="hidden" class="cl_regWord_prhibtYn" value="#{prhibtYn}"/>
							</td>
													<td>#fn{fnBindCodeListObj('WRDCDTY', 'text', '#{wrdTyCd}', '')}</td>
							<td class="alignl">#{wrdNm}</td>
							<td class="alignl">#{wrdEngAbrvNm}</td>
							<td class="alignl">#{wrdEngNm}</td>
							<td>#{stdWrdNm}</td>
							<td>#{relWrdNm}</td>
							<td>#{prhibtYn}</td>
							<td>#fn{fnBindCodeListObj('CONFMCDTY', 'text', '#{aprvSttusCd}', '')}</td>
							<td>#{wrdUseCnt}</td>
							<td class="noRegist">#{noRegist}</td>
							<td class="chk_td">
								<input type="checkbox" name="chkWrdNm" data-stdsetsn="#{stdSetSn}" data-wrdsn="#{wrdSn}" data-wrdengnm="#{wrdEngNm}" data-wrdengabrvnm="#{wrdEngAbrvNm}" data-wrdnm="#{wrdNm}">
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
	
	<div class="pop_footer">
	</div>

<script type="text/javascript">

$(document).ready(function() {
	var stdSetSn = parent.$("#topgv_stdSetSn").val();
	if(stdSetSn == undefined || stdSetSn == ""){
		return;
	}
	fnInitRegWordform(stdSetSn);
	
});

function fnInitRegWordform(stdSetSn) {
	
	new CodeBinder()
		.setCommonCode("WRDCDTY", "regWordTyCd", "radio")
		.setSqlCode("meta_code.selectDomnGroupCodeList","regWordDomnGroupCode", "select")
		.setSqlCode("meta_code.selectDomnNmList:stdSetSn="+stdSetSn, "ul_results" , "ul")
		.setLoadCallbackFunc("fnCodeLoadCallbackRegWord()")
		.load();
}

function fnCodeLoadCallbackRegWord() {
	$("#regWordSearchNm").on("keyup", function(event) {
		if(event.keyCode == 13)
			fnSearchWordNmListBtn();
	})
	
	// 용어구분
	$("#regWordTyCd").change(function() {
		
		var idVal = $("#regWordTyCd :checked").attr("id");

		var regWordTyCdNmHide = $("label[for="+idVal+"]").text();
		
		$("#regWordTyCdNmHide").val(regWordTyCdNmHide);
		
		
	});
	var i = "";
	var idx = 0;
	$("html").mouseup(function(e) {
		var target = $("#div_drop");
		if(target.has(e.target).length == 0){
			target.css("display", "none");
		}
		
		if($("#regWordDomnNm").val() == ""){
			fnSelectedDomnValueAndDomnGroup("", "", "", "");
		}
	});
	
	// 체크 이벤트
	$("#regWordDomnNm").on("click", function(e) {
		$("#div_drop").css("display", "");
		if($("#div_drop li").length == 0){
			return false;
		}

		idx = 0;
		var showLiCnt = 0;
		$("#div_drop li").each(function(){
			if($(this).css("display") != "none"){
				showLiCnt++;
			}
		});
		
		if($(this).val()!=""){
			if(showLiCnt > 0){
				fnDomnNmSearch($(this).val(), i, idx);
			} 
		} else {
			fnDomnNmSearch($(this).val(), i, idx);
			//fnMultiCodeListScrollControl("div_drop", "ul_results", i , idx);
		}
	});
	// 입력 이벤트
	$("#regWordDomnNm").on("input", function() {
		$("#div_drop").css("display", "");
		idx = 0;
		fnDomnNmSearch($(this).val(), i, idx);
	});
	
	// 방향키 이벤트
	$("#regWordDomnNm").on("keydown", function(e) {
		var thisVal = $(this).val();
		// enter
		if(e.keyCode == 13){
			$("#div_drop"+i+"").css("display", "none");
			var domnNm = $("#div_drop").find("[data-option-index =\""+idx+"\"]").attr("value");
			var domnSn = $("#div_drop").find("[data-option-index =\""+idx+"\"]").data("code"); 			// 도메인순번
			var domnGroupSn =$("#div_drop").find("[data-option-index =\""+idx+"\"]").data("extval");	// 도메인그룹
			var domnStdSetSn = $("#div_drop").find("[data-option-index =\""+idx+"\"]").data("extval2"); // 표준세트
			fnSelectedDomnValueAndDomnGroup(domnNm, domnSn, domnStdSetSn, domnGroupSn);
		}
		// backspace
		if(e.keyCode == 8){
			fnSelectedDomnValueAndDomnGroup(thisVal, "", "", "");
		}
		
		// tab
		if(e.keyCode == 9){
			$("#div_drop"+i+"").css("display", "none");
		}
		
		// 방향키 up(38) down(40)
		if(e.keyCode == 38 || e.keyCode == 40){
			var len = $("#div_drop"+i+"").find("li").length - 1;
			var showLiCnt = 0;
			$("#div_drop li").each(function(){
				if($(this).css("display") != "none"){
					showLiCnt++;
				} 
			});
			
			if (showLiCnt == 0) {
				return;
			} else {
				len = showLiCnt - 1;	
			}
			$("#div_drop").each(function(){
				if($(this).find(".on").length == 0){
					fnMultiCodeListScrollControl("div_drop", "ul_results", i , idx);
				} else {
					if(len > 0){
						// 방향키 up
						if(e.keyCode == 38){
							if(idx > 0){
								idx--;
							}
						// 방향키 down
						} else if(e.keyCode == 40) {
							
							if(idx < len){
								idx++;
							}
						}
		 				fnMultiCodeListScrollControl("div_drop", "ul_results", i , idx);
					}
				}
			});
			
			return false;
		}
	});
	// 마우스 커서 이벤트
	$("#div_drop li").hover(function() {
		$("#div_drop").each(function(){
			$(this).find("li").removeClass("on");
		});
		idx = $(this).data("option-index");
		$(this).addClass("on");
	},function(){
		$("#div_drop").each(function(){
			$(this).find("li").removeClass("on");
		});
		idx = 0;
	});

	$("#div_drop li").on("click", function() {
		var domnNm = $(this).attr("value");
		var domnSn = $(this).data("code"); 			// 도메인순번
		var domnGroupSn = $(this).data("extval");	// 도메인그룹
		var domnStdSetSn = $(this).data("extval2"); // 표준세트
		fnSelectedDomnValueAndDomnGroup(domnNm, domnSn, domnStdSetSn, domnGroupSn);
		//selectDomnGroup(domnGroupSn);
		
		//$("#row_"+i+"").find("input[name=multiDomnGroupSnHide]").val(domnGroupSn);
		
		$(".div_drop").css("display", "none");
	});
	
	
	$("#regWordDomnNm").on("blur", function(e) {
		var domnNm = $(this).val();

		$("#div_drop ul li").each(function(){
			var value = $(this).attr("value");
			var domnSn = $(this).data("code"); 			// 도메인순번
			var domnGroupSn = $(this).data("extval");	// 도메인그룹
			var domnStdSetSn = $(this).data("extval2"); // 표준세트
			
			if(domnNm == value){
				fnSelectedDomnValueAndDomnGroup(value, domnSn, domnStdSetSn, domnGroupSn);
			}
		});		
	
		
	});
	
	$("#regWordDomnNm").on("focus", function(e) {
		$("#div_drop").css("display", "");
	});
	
	
}
function fnSelectedDomnValueAndDomnGroup(domnNm, domnSn, domnStdSetSn, domnGroupSn){
	$("#regWordDomnNm").val(domnNm);
	$("#regWordDomnSnHide").val(domnSn)
	$("#regWordDomnRefrnStdSetSnHide").val(domnStdSetSn);
	
	$("#regWordDomnGroupCode option").each(function(){
		var value = $(this).val();
		if(value == domnGroupSn){
			$(this).val(domnGroupSn).prop("selected", true);
			var textVal = ""
			if(domnGroupSn != ""){
				textVal = $(this).text()
			}
			
			$("#regWordDomnGroupNmHide").val(textVal);
		}
	});
}

//용어 일괄 등록 쪽 도메인명 검색
function fnDomnNmSearch(searchText, i, idx){
	searchText = searchText.toUpperCase();
	var optionIndexCnt = 0;
	$("#div_drop"+i+" li").each(function() {
		$(this).hide();
		$(this).attr("data-option-index", "");
		
		if(($(this).text()).indexOf(searchText) > -1) {
			$(this).closest("li").show();
			$(this).attr("data-option-index", optionIndexCnt++);
		}
	});
	if(optionIndexCnt > 0 ){
		fnMultiCodeListScrollControl("div_drop", "ul_results", i , idx);
	}
}

// 수정 데이터 조회
function fnRegWordSearch(wordSn, pmode) {
	fnRegCloseCheckWordNmBtn();
	
	if (!wordSn)
		wordSn="";
	
	$("#regWordSnHide").val(wordSn);
	$("#regWordPmodeHide").val(pmode);
	
	if (pmode == "M") {

		$("#regWord_tr_row0").hide(); // 용어검색 row 안 보이도록
		
		$.ajax({
			url : "/json/stdDicary/getStdDicaryWordInfo"
			, method : "POST"
			, contentType : 'application/json'
			, data : JSON.stringify({
				wordSn : wordSn
				, pmode : pmode
			})
			, success : function(data) {
				var wordInfo = data.info;
				var wordTyCd = wordInfo.wordTyCd;
				$("#regWordTyCdNmHide").val(wordInfo.wordTyCdNm);					// hidden value 용어구분이름
				$("#regWordAprvSttusCdNmHide").val(wordInfo.aprvSttusCdNm); 		// hidden value 승인상태
				$("#regWordDomnGroupNmHide").val(wordInfo.domnGroupNm)				// hidden value 도메인그룹
				$("#regWordDomnSnHide").val(wordInfo.domnSn);						// hidden value 도메인순번
				$("#regWordDomnRefrnStdSetSnHide").val(wordInfo.domnRefrnStdSetSn);	// hidden value 도메인관련표준세트
				
				$("#regWordTyCd input:radio[name=WRDCDTY]:input[value="+wordTyCd+"]").prop("checked", true); // 용어구분
				$("#regWordAprvSttusCdNm").text(wordInfo.aprvSttusCdNm);						// 승인상태
				$("#regWordNm").val(wordInfo.wordNm); 											// 용어명
				$("#regWordEngNm").val(wordInfo.wordEngNm);										// 영문명
				$("#regWordEngAbrvNm").val(wordInfo.wordEngAbrvNm);								// 영문약어명
				$("#regWordPrhibtYn input:radio[name=wordPrhibtYn]:input[value="+wordInfo.prhibtYn+"]").prop("checked", true); // 금칙어
				$("#regWordRelWordNm").val(wordInfo.relWordNm); 			// 연관어
				$("#regWordDomnGroupCode").val(wordInfo.domnGroupSn); 		// 도메인그룹
				$("#regWordDomnNm").val(wordInfo.domnNm);					// 도메인명
				$("#regWordCn").val(wordInfo.wordCn);						// 단어설명

				$("#regWordTyCd input:radio[name=WRDCDTY]").attr("disabled", true);
			}
		});
	} else {
		$("#regWord_tr_row0").show();				//용어검색 row 보이도록
		
		$("#regWordSnHide").val("");				// hidden value 용어 순번 초기화
		$("#regWordTyCdNmHide").val(""); 			// hidden value 용어구분 이름
		$("#regWordAprvSttusCdNmHide").val("등록");	// hidden value 승인상태
		$("#regWordDomnGroupNmHide").val("")		// hidden value 도메인그룹
		$("#regWordDomnSnHide").val("");			// hidden value 도메인순번
		$("#regWordDomnRefrnStdSetSnHide").val("");	// hidden value 도메인관련표준세트
		
		$("#regWordAprvSttusCdNm").text("등록");						// 승인상태
		$("#regWordSearchNm").val("");								// 용어검색
		$("#regWordTyCd input:radio[name=WRDCDTY]:input[value=TYPE01]").prop("checked", true);		// 단어구분
		$("#regWordNm").val(""); 									// 용어명
		$("#regWordEngNm").val(""); 								// 영문명
		$("#regWordEngAbrvNm").val(""); 							// 영문약어명
		$("#regWordPrhibtYn input:radio[name=wordPrhibtYn]:input[value=N]").prop("checked",true);	// 금칙어
		$("#regWordRelWordNm").val(""); 							// 연관어
		$("#regWordDomnGroupCode").val(""); 						// 도메인그룹
		$("#regWordDomnNm").val(""); 								// 도메인명
		$("#regWordCn").val(""); 									// 용어설명
		
		$("#regWordTyCd input:radio[name=WRDCDTY]").attr("disabled", false);
	}
}

// 용어명 검사 닫기 버튼
function fnRegCloseCheckWordNmBtn() {
	
	$('#dv_wordnmlist_div').hide();
	$("#regWord_tr_row3, #regWord_tr_row4, #regWord_tr_row5, #regWord_tr_row6").show();
	
}

//용어명 조회 버튼
function fnSearchWordNmListBtn() {
	var wordNm = $("#regWordSearchNm").val().toUpperCase();
	if (wordNm == "") {
		alert("검색어를 입력해주세요");
		$("#regWordSearchNm").focus();
		return;
	} 
	
	$('#dv_wordnmlist_div').show();
	$("#regWord_tr_row3, #regWord_tr_row4, #regWord_tr_row5, #regWord_tr_row6").hide();

	// 기존 데이터 내용 제거
	fnClearBindData("tb_wordnmlist_table");
	
	$.ajax({
		url : "/json/stdDicary/getStdDicarySearchWordNmWrdList"
		, method : "POST"
		, contentType : 'application/json'
		, data : JSON.stringify({
			wordNm : wordNm
		})
		, success : function(data) {
			var list = data.list;
			
			fnBindTableValue("tb_wordnmlist_table", list);
			
			var myStdSetSn = parent.$("#topgv_stdSetSn").val();
			
			$("#tb_wordnmlist_table tr.fwk_data_row").each(function(){
				var aprvSttusCd = $(this).find(".cl_regWord_aprvSttusCd").val();
				var stdSetTyCd = $(this).find(".cl_regWord_stdSetTyCd").val();
				var stdSetSn = $(this).find(".cl_regWord_stdSetSn").val();
				var wrdSn = $(this).find(".cl_regWord_wrdSn").val();
				var noRegist = $(this).find(".noRegist");
				
				var prhibtYn = $(this).find(".cl_regWord_prhibtYn").val();
				var noRegistText = "";
				
				if (stdSetTyCd != "COMMON") {
					if (aprvSttusCd =="APPROVAL") {
						if (myStdSetSn != stdSetSn && prhibtYn !="Y") {
							$(this).find("input:checkbox[name=chkWrdNm]").remove();
							var addBtn = "<button class='btn sm' name='addWrdBtn' data-stdsetsn="+stdSetSn+" data-wrdsn="+wrdSn+"  onclick='fnAddWrdBtn(this); return false;'>저장</button>";
							$(this).find(".chk_td").append(addBtn);
						}
						
						if(prhibtYn =="Y"){
							$(this).find("input:checkbox[name=chkWrdNm]").remove();
							noRegistText = "금칙어";
						}
					} else {
						$(this).find("input:checkbox[name=chkWrdNm]").remove();
						noRegistText = "미승인단어";
					}
					if(noRegistText != ""){
						noRegist.text(noRegistText);
					}
				}
			});
			
			// 전체 선택 초기화
			$("#regSearchedWrdSelectAll").attr("data-chkselected", "N");
		}
	});
}

// 다른 표준세트 단어 등록
function fnAddWrdBtn(obj){
	var stdSetSn = $(obj).data("stdsetsn");
	var wrdSn = $(obj).data("wrdsn");
	
	if(g_isApprover == "Y"){
		if(!confirm("승인 하시겠습니까?")){
			return;
		}
	} else{
		if(!confirm("승인요청 하시겠습니까?")){
			return;
		}
	}
		
	$.ajax({
		url : "/json/stdDicary/getStdDicarySaveOtherWrdInfo"
		, method : "POST"
		, contentType : 'application/json'
		, data : JSON.stringify({
			isApprover : g_isApprover
			, stdSetSn : stdSetSn
			, wrdSn : wrdSn
			, pmode : "R"
		})
		, success : function(data) {
			if (data.resultCd == "OK") {
				if(g_isApprover == "Y"){
					alert("승인 되었습니다.");
				} else{
					alert("승인요청 되었습니다.");
				}
				fnSearchWordNmListBtn();
			} else {
				alert("실패하셨습니다.");
				fnSearchWordNmListBtn();
			}
		}
	});
	
	
}

 
// 용어명 상세조회 체크 확인 버튼
function fnRegChkBoxSlctnBtn() {
	
	
	var wrdNm = "";
	var wrdEngNm = "";
	var wrdEngAbrvNm = "";
	var wrdSnArry = [];	
	var wrdStdSetSnArry = [];	
	var checkCnt = 0; 
	
	$("#tb_wordnmlist_table input:checkbox[name='chkWrdNm']").each( function() {
		if ($(this).is(":checked") == true) {
			
			var wrdNmObj = {};
			var wrdEngNmObj = {};
			var wrdEngAbrvNmObj = {};
			

			wrdSnArry.push($(this).data("wrdsn"));
			wrdStdSetSnArry.push($(this).data("stdsetsn"));
			
			wrdNmObj.wrdNm = $(this).data("wrdnm");
			wrdEngNmObj.wrdEngNm = $(this).data("wrdengnm");
			wrdEngAbrvNmObj.wrdEngAbrvNm = $(this).data("wrdengabrvnm");
			
			wrdNm += (wrdNmObj.wrdNm + "_");	// 논리명
			wrdEngNm += (wrdEngNmObj.wrdEngNm + " ");
			wrdEngAbrvNm += (wrdEngAbrvNmObj.wrdEngAbrvNm + "_");	// 물리명
			checkCnt++;
		}
	});
	
	
	// 선택 안했을때 초기화
	if(checkCnt == 0 || checkCnt == 1) {
		wrdSnArry = [];
		wrdStdSetSnArry = [];
		$("#regWordEngNm").val("");
		$("#regWordEngAbrvNm").val("");
		if(checkCnt == 1) {
			alert("용어는 단어의 2개 이상의 조합으로 생성 할수 있습니다. ");
		}
		return;
	} 
	// 공백 제거
	var resWrdEngNmVal = $.trim(wrdEngNm);
	var resWrdEngAbrvNmVal = wrdEngAbrvNm.replace(/\s/gi, "");
	var resWrdNmVal = wrdNm.replace(/\s/gi, "");
	
	// 맨뒤에 _ 제거
	resWrdEngAbrvNmVal = resWrdEngAbrvNmVal.substring(0, resWrdEngAbrvNmVal.length -1);
	resWrdNmVal = resWrdNmVal.substring(0, resWrdNmVal.length -1);
	
	
	$("#regWordWrdSnHide").val(wrdSnArry);
	$("#regWordWrdRefrnStdSetSnHide").val(wrdStdSetSnArry);
	$("#regWordNm").val(resWrdNmVal);
	$("#regWordEngNm").val(resWrdEngNmVal);
	$("#regWordEngAbrvNm").val(resWrdEngAbrvNmVal);
	
	fnCheckDpcnEngAbrvNm(resWrdEngAbrvNmVal);
	//fnRegCloseCheckWordNmBtn();
	
}

// 용어명 상세조회 체크한 단어 조합 영문약어명 중복체크
function fnCheckDpcnEngAbrvNm(wordEngAbrvNm){
	
	$.ajax({
		url : "/json/stdDicary/getCheckDpcnNm"
		, method : "POST"
		, contentType : 'application/json'
		, data : JSON.stringify({
			cmprWordEngAbrvNm : wordEngAbrvNm
		})
		, success : function(data) {
			if (data.resultCd == "OK") {
				fnRegCloseCheckWordNmBtn();
			} else {
				alert(data.errorInfo);
				$("#regWordWrdSnHide").val("");
				$("#regWordWrdRefrnStdSetSnHide").val("");
				$("#regWordNm").val("");
				$("#regWordEngNm").val("");
				$("#regWordEngAbrvNm").val("");
			}
		}
	});
	
}

// 저장 버튼
function fnRegWordBtn() {

	if (!fnCheckValid("#regWordTyCd  :checked", "용어구분"))
		return;
	
	if (!fnCheckValid("#regWordNm", "용어명"))
		return;

	if (!fnCheckValid("#regWordEngAbrvNm", "영문약어명"))
		return;
			
	if (!fnCheckValid("#regWordEngNm", "영문명"))
		return;

	if (!fnCheckValid("#regWordPrhibtYn :checked", "금칙어"))
		return;
		
	
	//if (!fnCheckValid("#regWordDomnGroupCode", "도메인그룹"))
	//	return;
		
	if (!fnCheckValid("#regWordDomnNm", "도메인명"))
		return;
		
	if($("#regWordDomnSnHide").val() == "") {
		alert("등록되어 있지 않은 도메인명 입니다.");
		$("#regWordDomnNm").focus();
		return;
	}
	
	if (!confirm("등록하시겠습니까?"))
		return;

	var pmode = $("#regWordPmodeHide").val();
	var chgKeyList = "";

	// 작성한 정보
	var wordMap = {
			wordSn : $("#regWordSnHide").val()
			, wrdSn : $("#regWordWrdSnHide").val()
			, wrdRefrnStdSetSn : $("#regWordWrdRefrnStdSetSnHide").val()
			, wordTyCdNm : $("#regWordTyCdNmHide").val()
			, aprvSttusCdNm : $("#regWordAprvSttusCdNmHide").val()
			, wordTyCd : $("#regWordTyCd :checked").val()
			, wordNm : $("#regWordNm").val().toUpperCase()
			, wordEngNm : $("#regWordEngNm").val().toUpperCase()
			, wordEngAbrvNm : $("#regWordEngAbrvNm").val().toUpperCase()
			, prhibtYn : $("#regWordPrhibtYn :checked").val()
			, relWordNm : $("#regWordRelWordNm").val()
			, domnGroupSn : $("#regWordDomnGroupCode").val()
			, domnGroupNm : $("#regWordDomnGroupNmHide").val()
			, domnNm : $("#regWordDomnNm").val()
			, domnSn : $("#regWordDomnSnHide").val()
			, domnRefrnStdSetSn : $("#regWordDomnRefrnStdSetSnHide").val()
			, wordCn : $("#regWordCn").val()
	}
	
	// 변경 히스토리 저장 항목 정의 
	if (pmode == "M") {
		chgKeyList = [
			{"wordTyCdNm":"용어구분"}
			, {"aprvSttusCdNm":"승인상태"}
			, {"wordNm":"단어명"}
			, {"wordEngNm":"영문명"}
			, {"wordEngAbrvNm":"영문약어명"}
			, {"prhibtYn":"금칙어"}
			, {"relWordNm":"연관어"}
			, {"domnGroupNm":"도메인그룹"}
			, {"domnNm":"도메인명"}
			, {"wordCn":"단어설명"}
		];
	}
	
	var pagingNo ="";
	$("#dv_paging .on a").each(function(){
		pagingNo = $(this).text();
	});
	
	$.ajax({
		url : "/json/stdDicary/saveStdDicaryWordInfo"
		, method : "POST"
		, contentType : 'application/json'
		, data : JSON.stringify({
			pmode : pmode
			, isApprover : g_isApprover
			, wordMap : wordMap
			, chgKeyList :chgKeyList
		})
		, success : function(data) {
			if (data.resultCd == "OK") {
				alert("저장되었습니다.");
				fnCloseModal('wordreginfo_modal');
				fnWordSearch(pagingNo);
			} else {
				alert("실패하셨습니다.");
			}
		}
	});
}

function fnRegSearchedWrdSelectAll() {
	
	var selectedYn = $("#regSearchedWrdSelectAll").attr("data-chkselected");
	
	$("#tb_wordnmlist_table .fwk_data_row .chk_td input[name=chkWrdNm]").each(function() {
		if(selectedYn == "Y")
			$(this).prop("checked", false);
		else 
			$(this).prop("checked", true);
	});
	
	if(selectedYn == "Y")
		$("#regSearchedWrdSelectAll").attr("data-chkselected", "N");
	else 
		$("#regSearchedWrdSelectAll").attr("data-chkselected", "Y");
	
}

</script>
</th:block>